% Version 0; Only rough outline by SH

\documentclass{pasj01}

%% ------------------------------------------------------------------------------------ %% 
% Packages
%\usepackage{emulateapj5}
%\usepackage{apjfonts}
%\usepackage{amssymb, amsmath}
%\usepackage{graphicx}
\usepackage{url}
%\usepackage{CJK}    
\usepackage{natbib}
\usepackage{hyperref}
\usepackage[usenames]{color}

% Package Settings
\bibliographystyle{apj}
\hypersetup{colorlinks=true,
            citecolor=cyan,
            linkcolor=cyan,
            filecolor=magenta,      
            urlcolor=cyan}
\urlstyle{same}
%% ------------------------------------------------------------------------------------ %% 

% Figure extension
\DeclareGraphicsExtensions{.pdf,.png,.jpg}

%%%%%%%%%%%%: User Defined Commands %%%%%%%%%%%%

%% ------------------------------------------------------------------------------------ %% 
% Song Huang's definition 
\def\arcsec{{\prime\prime}}
\def\arcmin{{\prime}}
\def\degree{{\circ}}
\def\h{\hskip -3 mm}
\def\amin{$^\prime$}
\def\asec{$^{\prime\prime}$}
\def\deg{$^{\circ}$}
\def\ddeg{{\rlap.}$^{\circ}$}
\def\dsec{{\rlap.}$^{\prime\prime}$}
\def\hst{{\textit{HST}}}
\def\lax{{$\mathrel{\hbox{\rlap{\hbox{\lower4pt\hbox{$\sim$}}}\hbox{$<$}}}$}}
\def\gax{{$\mathrel{\hbox{\rlap{\hbox{\lower4pt\hbox{$\sim$}}}\hbox{$>$}}}$}}
\def\simlt{\lower.5ex\hbox{$\; \buildrel < \over \sim \;$}}
\def\simgt{\lower.5ex\hbox{$\; \buildrel > \over \sim \;$}}
\def\micron{{$\mu$m}}
\def\perang{\AA$^{-1}$}
\def\peryr{yr$^{-1}$}
\def\sb{mag~arcsec$^{-2}$}
\def\lsun{$L_\odot$}
\def\msun{$M_\odot$}
\def\sigs{$\sigma_*$}

\def\etal{{\ et al.~}}
\def\galfit{{\tt GALFIT}}
\def\ser{{S\'{e}rsic\ }}
\def\redm{\texttt{redMaPPer}~}
\def\synpipe{\texttt{SynPipe}~}
\def\redbcg{{$\Lambda \ge 30$}}
\def\nonbcg{{$\Lambda < 20$}}
\def\logms{{$\log (M_{\star}/M_{\odot})$}~}
\def\mstar{{$M_{\star}$}~}
\def\logmh{{$\log (M_{\mathrm{Halo}}/M_{\odot})$}~}
\def\m2l{{$M_{\star}/L_{\star}$}~}
%% ------------------------------------------------------------------------------------ %% 

% Commenting:
%% ------------------------------------------------------------------------------------ %% 
\definecolor{gray}{rgb}{0.6, 0.6, 0.6}
\newcommand{\plan}[1]{\textcolor{blue} {\textbf{#1}}}
\newcommand{\todo}[1]{\textcolor{red} {\textbf{#1}}}
\newcommand{\song}[1]{\textcolor{gray} {\textbf{#1}}}
\newcommand{\addref}{{\textcolor{red}{REF}}}

%%%%%%%%%%%%: Header and Version %%%%%%%%%%%%

%% ------------------------------------------------------------------------------------ %% 

\begin{document}

\SetRunningHead{Huang et al.}{HSC-SSP SynPipe}

\Received{$\langle$April 2017$\rangle$}
%\Accepted{$\langle$2017$\rangle$}
%\Published{$\langle$2017$\rangle$}

%%%%%%%%%%%%: Title and Affiliations %%%%%%%%%%%%

%% ------------------------------------------------------------------------------------ %% 
\title{SynPipe: Synthetic Object Pipeline for the Hyper Suprime-Cam 
       Strategy Survey Program}

\author{Song Huang \altaffilmark{1,2}
        Alexie Leauthaud \altaffilmark{1,2}, 
        Claire Lackner \altaffilmark{1},
        Jim Bosch \altaffilmark{3},
        Paul Price \altaffilmark{3},
        Steven Bickerton \altaffilmark{1},
        Ryoma Murata \altaffilmark{1, 4}, 
        Rachel Mandelbaum \altaffimark{5},
        HSC Collaboration \altaffilmark{6},
        }                                          
%% ------------------------------------------------------------------------------------ %% 

\altaffiltext{1}{Kavli Institute for the Physics and Mathematics of the 
    Universe, The University of Tokyo Institutes for Advanced Study, 
    the University of Tokyo (Kavli IPMU, WPI), Kashiwa 277--8583, Japan}
\altaffiltext{2}{Department of Astronomy and Astrophysics, University of California, 
    Santa Cruz, 1156 High Street, Santa Cruz, CA 95064 USA}
\altaffiltext{3}{Department of Astrophysical Sciences, Princeton University, 
    4 Ivy Lane, Princeton, NJ 08544}
\altaffiltext{4}{Department of Physics, University of Tokyo, Tokyo 113-0033, Japan}
\altaffiltext{5}{McWilliams Center for Cosmology, Department of Physics, 
    Carnegie Mellon University, Pittsburgh, PA 15213, USA}
\altaffiltext{6}{Other affiliations}

\email{song.huang@ipmu.jp}
%% ------------------------------------------------------------------------------------ %% 

%%%%%%%%%%%%: Abstract and Keywords %%%%%%%%%%%%

%% ------------------------------------------------------------------------------------ %% 
\KeyWords{Surveys, 
          Methods: observational, 
          Techniques: photometric}
          
\maketitle

%% ------------------------------------------------------------------------------------ %% 
\begin{abstract}
    The Subaru Strategy Survey Program (SSP) is an ambitious multiband imaging
          survey using the Hyper Suprime-Cam (HSC).
          The HSC collaboration has developed sophisticated data reduction pipeline
          that will also be used by the Large Synoptic Survey Telescope. 
          Here we introduce the SynPipe: a flexible framework to test the performance 
          of HSC pipeline using synthetic stellar and extended objects. 
          Through injecting synthetic objects to images from individual exposures, 
          SynPipe creates realistic coadd images and photometric measurements for them
          In this work, we demonstrate the basic photometric performance of HSC pipeline
          using synthetic stars and galaxies close to the expected detection limit of 
          SSP Wide survey. 
          SynPipe is also being used to test the selection of background galaxies for 
          weak lensing analysis, the detection of high redshift dropouts, and photometry 
          of low surface brightness objects.
\end{abstract}
%% ------------------------------------------------------------------------------------ %% 

%%%%%%%%%%%%: Main Text %%%%%%%%%%%%

%% ------------------------------------------------------------------------------------ %% 
\section{Introduction}
    \label{sec:intro}
      
    \todo{SSP/HSC background \citealt{Suchyta2016}}
    \begin{itemize}
        \item \plan{Why large imaging survey? Basic scientific application: cosmology, 
                    galaxy evolution, galactic structure, and trasient objects.} 
        \item \plan{Brief background about HSC and SSP. 
                    Could borrow a few paragraph from the camera and survey design paper, 
                    rewrite in slightly different way.}
        \item \plan{Accurate photometry becomes very challenging, hence requires careful 
                    systematic tests.}
        \item \plan{Briefly mentions similar efforts from DES collaboration. e.g. 
                    \texttt{Balrog} (\citep{Suchyta2016}) and there is another one\ldots}
    \end{itemize}

%% ------------------------------------------------------------------------------------ %% 

\section{HSC Pipeline Overview}

    \todo{Brief introduction of the HSC pipeline.}
    \begin{itemize}
        \item \plan{Basic workflow of the HSC pipeline, 
                    can borrow something from Jim's paper, and rewrite in our own words.}
        \item \plan{Emphasize the new algorithms used by HSC pipeline, and the 
                    improvements compared with other surveys.}
        \item \plan{Explain the most important features that are worth testing:
                    1. Detection of sources down to the survey limit;
                    2. PSF magnitude and colors for stellar objects;
                    3. cModel photometry for galaxies;
                    4. Impact of ``blendedness'' on photometry;
                    5. Impact of proximity to bright stars on photometry (?)
                    6. Star-Galaxy separation (?)}   
    \end{itemize}

%% ------------------------------------------------------------------------------------ %% 

\section{SynPipe Overview}

    \plan{The following paragraph is prepared for the weak lensing shape catalog paper, 
          only show here as a place holder \ldots}
          
    \begin{itemize}
        \item \plan{Basic design of SynPipe:
                    1. Flexible, highly integrated with HSC pipeline;
                    2. Why we want to inject synthetic objects onto single 
                       exposures instead of directly putting them on coadd?}
        \item \plan{Since we simulate the real data reduction process as much 
                    as possible, SynPipe will generate the same amount of data
                    as the real HSC pipeline.  We do not plan to apply SynPipe
                    to the entire HSC survey, but use it to test the performance 
                    of HSC pipeline on a representative subset of data.}         
    \end{itemize}
    
    \todo{Need a flow-chart to visualize the procedures of SynPipe}

    To evaluate the performence of \texttt{hscPipe}, including the photometry and shape 
    measurements that are related to weak lensing analysis, we design a flexible framework 
    (\texttt{SynPipe}\footnote{https://github.com/clackner2007/fake-sources}) to conduct 
    systematic tests by injecting simulated images of galaxies on to the HSC images.  
    \texttt{SynPipe} read positions and detailed model information of the fake objects from an
    input catalog.  By default, it provides the functions to help you randomly inject objects 
    on a single \texttt{Tract} according to required number density, or put fake objects on 
    an evenly separated grid given expected distance between objects. 

    \texttt{SynPipe} uses \texttt{GalSim\ v1.4} (Rowe\ et al.\ 2015) as backend to reliably
    simulate images of fakes objects.  So far, the fake object can be either star or galaxies
    that are described by single- or double-{S\'{e}rsic} models.  In stead of providing the
    model parameters in the input catalog, we also support the parametric models of
    $I_{\mathrm{F814W}} \leq 25.2$ COSMOS galaxies provided by
    \texttt{GalSim.COSMOSCatalog()}, which is very similar to the input catalog of the
    \texttt{GREAT3} challenge (Mandelbaum\ et al.\ 2013).   Using model identifications in the
    input catalog, \texttt{GalSim} will generate images of the best parametric models (either
    single-{S\'{e}rsic} or {S\'{e}rsic}-bulge plus exponential disk).  Also, external shear
    can be added to fake object in the form of $g1$ and $g2$.  For model with high
    {S\'{e}rsic} index, the simulated image can truncate after certain times of the effective
    radius by request to improve the speed.  

    To make the image simulation process as realistic as possible, \texttt{SynPipe} injects
    fake objects directly onto images of individual CCD at the single exposure level, instead
    of putting them to the already stacked, final image products (e.g. Suchyta\ et al.\ 2015).
    In this way, the fake objects from different single exposures will go through the exactly
    same detecting, stacking, and measuring procedures as real ones.  Hence, the pipeline
    results on fake objects can share very similar systematical effects as real ones, which is
    important for tests related to weak lensing analysis. 

    Given certain input fake object, \texttt{SynPipe} converts the model magnitude into flux
    in requested HSC filter using the available photometric calibration.  For fake galaxy, we
    convolve the simulated image with PSF model estimated by \texttt{hscPipe} at the desired
    coordinate; and we model fake star by simply scaling the PSF model to the input flux.
    Then, we add the PSF-convolved snapshot to all single CCD images that overlaps with it
    according to available WCS information.  At the edge of the CCD, the simulated image will
    be clipped before adding to it.  Meanwhile, \texttt{SynPipe} adds a new mask plane
    (\texttt{FAKE}) on the existed one to highlight the regions affected by fake objects.
    After these fake-object-added images being reduced by \texttt{hscPipe}, we match the input
    coordinates of fake objects with the output catalogs within certain radius.  Cases of
    unmatched objects and multiple matches can be saved too when necessary.  

    Using the infrastructures provided by \texttt{hscPipe}, the above process (e.g. the 
    injection of fake objects) can be easily parallelized.  Hence, the overall efficiency of
    \texttt{SynPipe} is almost identical with the reduction processes of real data.  
    
%% ------------------------------------------------------------------------------------ %% 

\section{Test Design}

\todo{A lot to discuss here....}

\subsection{Selection of HSC Data}

    For this work, we focus on the HSC WIDE fields that have reached the designed 
    depth (covered by more than 4 exposures in $g$ and $r$ bands; and more than 6 
    exposures in $i$, $z$, and $y$ bands) in all five bands. 
    They represent the majority of images of HSC survey, and they are of great 
    scientific importance.  
    Also, for now, the HSC DEEP and UDEEP layers have not reached the expected depth. 
    
    During the image co-adding process, the celestial sphere is broken into a set 
    of fixed square regions referred as \texttt{Tract}, which are similar in size 
    to the field of view of the HSC camera. 
    Each \texttt{Tract} further contains $9\times9$ sub-regions named \texttt{Patch}. 
    And each \texttt{Patch} is $4200\times4200$ pixels in size. 
    Since we choose to make the \texttt{SynPipe} as realistic as possible, the volume 
    of data it creates is also the same with the real reduction.  
    For this reason, it is obviously not realistic to test the entire HSC WIDE 
    dataset.  
    But for the purpose of testing the photometric performance, representative subset
    of data is all we need. 
    For a single \texttt{Tract}, we can easily tens of thousands of objects 
    (actual number depends on the magnitude and size) for our tests.  
    
    Since the detection and measurement of objects close to the detection limit 
    strongly depends on the seeing; and the PSF photometry for point sources,  
    the \texttt{cModel} photometry for extended sources both depend on the PSF 
    model, we will test two \texttt{Tracts} that represent good and bad seeing 
    conditions in the $i$-band.  
    We focus on the $i$-band seeing because, as the default band for weak lensing 
    analysis, the $i$-band images are always observed under ideal seeing condition,
    and they are often used as the reference image in the multiband photometry of 
    \texttt{hscPipe}. 
    
    We choose \texttt{Tract} 8522 as example of field with bad $i$-band seeing 
    (average seeing is $\sim 0.9^{\arcsec}$); and \texttt{Tract} 9698 for regions 
    with good seeing ($\sim 0.6^{\arcsec}$; given the pixel size of HSC, the PSF 
    is not under-sampled).  
         
\subsection{Synthetic Stellar Object}
    
    For stellar objects, we make very simple assumption

    \begin{itemize}
        \item \plan{We simulate stellar object using the reconstructed PSF model given 
                    the desired coordinates at individual exposure level.  
                    The spatial variantion of seeing, and seeing difference among all 
                    exposures are naturally taken into account.}
        \item \plan{\textbf{Magnitude distribution}:
                    1: If we just want to test the PSF magnitude, we can use very 
                           simple distribution of magnitude, e.g flat distribution 
                           between 21 to 27 magnitude.
                    2: If we want to also focus on the detection limits and 
                           star-galaxy separation at faint end, we can inject more 
                           faint stars.  (e.g. Claire used to just inject large number 
                           of 26, 27 magnitude stars, and see how many are recovered).}
        \item \plan{\textbf{Color distribution}:
                    1: We can just make all color equal 0.0. This way, we can still 
                       test the PSF magnitude in each band independently.
                    2: Magnitude-dependent color distribution from ``real'' stars. 
                       This could be taken from other studies, or from the observed
                       HSC stars.  The only issue is that at very faint end, do we have
                       reliable information about the color distribution ? 
                       (and does it matter?)}
        \item \plan{\textbf{Number of Stars}:
                    For point sources, we can afford adding a large amount into one Tract. 
                    (e.g. 500-1000 per CCD). 
                    SH will check papers from other projects to see how many is considered 
                    large enough}
    \end{itemize}
    
    
\subsection{Synthetic Galaxy}

    \todo{\textbf{There are multiple decisions to be made here!!}}
    \begin{itemize}
        \item \plan{\textbf{Types of Synthetic Galaxies}:
                    1. Only single-\ser object or also want to try bulge$+$disk model? 
                    2. Besides the single-\ser model, which is ``more realistic'', do 
                       we want to test basic Exp and deV models.  
                       The Exp and deV models can be used to sanity-check the cModel 
                       photometry.  I have done this before, and the results look quite 
                       reasonable for \texttt{hscPipe\ v3.8.5}.}
        \item \plan{\textbf{Separate the low-\ser and high-\ser index ones?}
                    In the tests conducted by SH, the accuracy of cModel photometry shows
                    clear dependence on \ser index.  
                    In some of the tests, SH has separated the sample into two groups using
                    \ser index lower/higher than 2.5 to highlight such difference. 
                    If we will only single-\ser model, SH prefers to use this approach; 
                    If we choose to test Exp and deV models as while, it may not be necessary 
                    to do so; we can still show the dependece of systematical error on 
                    \ser index.}
        \item \plan{\textbf{Magnitude Distribution and Limit}:
                    Since we will be using Claire's catalog from COSMSO galaxies, we can 
                    simply randomly sample the given mangitude distribution.  
                    But, the amount of galaxies that are brighter than 22.0 mag is quite small, 
                    if we want to have reliable statistics at the bright end, we can also 
                    test the bright and faint galaxies separately.  SH has done this before. 
                   }
        \item \plan{\textbf{Structural Parameters}:
                    1. \ser index should be between 0.5 and 5.0.  
                       There are galaxies that appear to be more extended than that, 
                       but SH thinks single-\ser is no longer appropriate model for them.
                    2. Should have limit on effective radius (actually, the average surface 
                       brightness within effective radius) to exclude too ``diffuse'' objects.  
                       There are interesting diffuse galaxies, but in Claire's catalog, most 
                       of the diffuse models are due to problematic fitting results, especially 
                       at the faint end.  SH thinks that they should be removed.}
        \item \plan{\textbf{Color Distribution}:
                    1. Should mention that color gradient is not considered here.  
                       (which is possible if we change the size and/or \ser index in different 
                       band, or use different colors for bulge and disk.
                    2. Again, we could assume all color equal 0.0, and focus on the photometry 
                       in each band separately. 
                    3. Or we can use naive, but ``reasonable'' color: e.g. bluer color for 
                       low-\ser objects; redder color for high-\ser objects, which is used by SH
                       for previous test.
                    4. In principle, we can use the rich photometric data in COSMOS to come 
                       up with a realistic multiband catalog for Claire's model.}
       \item \plan{\textbf{Blendedness of Galaxies}:
                   1. We can avoid blending between two fake galaxies by designing the input 
                      catalog more carefully; or inject fake galaxies on a grid with large 
                      separation.
                   2. To test the impact of blendedness on the photometry, SH used to separate 
                      the galaxies with large blendedness from the pipeline. Meanwhile, we 
                      can only add fake galaxies near real objects, or adding pairs of fake 
                      objects.}
    \end{itemize}


\subsection{Running SynPipe Test}

    \plan{Briefly explain how the SynPipe runs are conducted.}
    \todo{Do we want to run afterburner.py, and test the color using PSF-matched 
          aperture photometry?}
          
    \begin{itemize}
        \item \plan{Prepare input catalogs, avoid adding fake objects on pixels affected 
                    by saturated or interpolated masks.} 
        \item \plan{Run stack.py and multiband.py using the default configuration of 
                    HSC pipeline; Do we also want to test the cModel photometry using 
                    per-pixel variance information?  Or should we try to turn on the 
                    garbage suppression?}
        \item \plan{Briefly explain the matching processes:
                    1. Match the input catalog with the pipeline outputs using 2 pixel 
                       matching radius; In case of multiple matches, all matches are kept 
                       in the catalog, but only the closest one is used for comparison.
                    2. Match the input catalog with the pipeline results from data without 
                       synthetic objects using a slightly larger matching radius.  This is 
                       mainly to see how many synthetic objects are heavily ``contaminated''
                       with the real objects.}
    \end{itemize}

%% ------------------------------------------------------------------------------------ %% 

\section{Results}

\subsection{Detection Limits of Point Sources (Optional)}

    \plan{It seems to SH that, if we seriously want to discuss this topic, we need to 
          design the tests very carefully; and the detection limits of point sources can 
          be tested using the ``sky object''. 
          But, we can still say a few words here.  Excluding the synthetic stars affected 
          by problematic pixels and real objects, we can simply summarize the fraction of 
          detected point sources at different magnitude and seeing condition.  
          We can also show a few examples of undetected stars.}
    
\subsection{Star-Galaxy Separation (Optional)}

    \plan{Again, this topic itself should deserve its own paper, and I know that Jose has 
          made a lot of improvements.  
          However, it is quite straightforward for SH to briefly mention something:
              1. Fraction of stars that are classified as galaxies; Their magnitude and 
                 blendedness distributions.
              2. Fraction of galaxies that are classified as stars; Their magnitude, 
                 blendedness, and structural parameter distributions. 
                 (In SH's previous test, faint, exponential-like galaxies are slightly 
                 more likely to be classified as stars)}
    
\subsection{Photometric Performance}

\subsubsection{General Behaviours (Optional)}
    
    \begin{itemize}
        \item \plan{What fraction of stars have failed PSF magnitude (should be very low)}
        \item \plan{What fraction of galaxies have failed (1) Kron, (2) cModel photometry;
                    Their magnitude, blendedness, structural parameter distributions; 
                    (In SH's previous tests, there are still a few percents of fake galaxies 
                     that have failed cModel; and it is slightly more likely for galaxy with 
                     high \ser index to have failed Kron or cModel.)}
    \end{itemize} 
    
\subsubsection{PSF photometry of Stars}

    \begin{itemize}
        \item \plan{Magnitude v.s. $\Delta$(Magnitude) for different seeing conditions.}
        \item \plan{Magnitude v.s. $\Delta$(Color); Color v.s. $\Delta$(Color) for 
                    different seeing conditions.}
        \item \plan{Discuss the impact from ``blendedness'' and bright object masks.}
    \end{itemize} 

\subsubsection{Kron photometry of Galaxies}

    \begin{itemize}
        \item \plan{Magnitude v.s. $\Delta$(Magnitude) for different seeing conditions.
                    Can also separate them into low- and high-\ser index groups.}
        \item \plan{Magnitude v.s. $\Delta$(Color); Color v.s. $\Delta$(Color) for 
                    different seeing conditions; 
                    Can also separate them into low- and high-\ser index groups.}
        \item \plan{Discuss the impact from ``blendedness'' and bright object masks.}
    \end{itemize} 

\subsubsection{cModel photometry of Galaxies}

    \begin{itemize}
        \item \plan{Magnitude v.s. $\Delta$(Magnitude) for different seeing conditions.
                    Can also separate them into low- and high-\ser index groups.}
        \item \plan{Magnitude v.s. $\Delta$(Color); Color v.s. $\Delta$(Color) for 
                    different seeing conditions; 
                    Can also separate them into low- and high-\ser index groups.}
        \item \plan{Discuss the impact from ``blendedness'' and bright object masks.}
        \item \plan{If we decide to test the Exp and deV models, we can show results for 
                    cmolde.exp and cmodel.dev photometry first}
    \end{itemize} 

\subsubsection{Color using PSF-matched Aperture Photometry (Optional)}

    \todo{Depends on whether we want to test the afterburner.}
    
    \plan{Focus on whether the afterburner results can help improve the accuracy of 
          color for galaxies, especially the ones with very high blendedness.}

\subsubsection{Shape and Structural Parameters of Galaxies (Optional)}
    
    \todo{Decide whether to include this.}
    \plan{Using the default pipeline configuration, cModel still shows serious biases in 
          recovering the size and shape of galaxies.  We can:
          1. Do not show results here, but mention a few words in the Future Plans section 
             below: ``We are aware that the cModel and the configuration has some issues, 
             we will use SynPipe to see if we can improve this.''
          2. Show the results, explain the main reasons for these problems, and use it as 
             a warning to people who want to use these results.
          3. Comparisons with the results from test using the per-pixel variance information 
             for cModel.  (SH's previous test during the Taipei meeting shows clear 
             improvements)
          }
          
    \plan{Relationship between the fracDev and the \ser index of galaxies (or other parameters).  
          In SH's previous test, fracDev is only useful to separate low- and high-\ser index 
          galaxies when they are brighter than 21 mag in i-band.}

%% ------------------------------------------------------------------------------------ %% 

\section{Conclusions and Future Plans}

    \plan{Summary of the paper}
    \begin{itemize}
        \item \plan{Basically the information in abstract, but in different way.}
        \item \plan{Summarize the basic performance of HSC pipeline into a few 
                    bullet points.} 
    \end{itemize}
    
    \plan{Other applications of the SynPipe (just mentioned a few here)}
    \begin{itemize}
        \item \plan{Can be used as a standard QA tools for future data release and 
                    pipeline update;  Can be used to tweak configuration of pipeline
                    to improve the photometry of certain objects (useful for 
                    other HSC users).}
        \item \plan{Ryoma Murata's tests and other tests related to weak lensing shape 
                    catalog.}
        \item \plan{Ono-san's test on the detection of dropouts (have not contacted 
                    Ono-san to see if he want to be mentioned here)}
        \item \plan{Johnny Greco and SH's test about the detection of ultra-diffuse 
                    galaxies (UDG).}
    \end{itemize}

    \plan{Further improvements of the SynPipe}
    \begin{itemize}
        \item \plan{More flexible, realistic models for galaxies.}
        \item \plan{For many purposes, it should be Ok to directly inject synthetic 
                    objects onto the deepCoadd images. 
                    This can improve the efficiency.}
        \item \plan{Only do photometric measurements on objects that overlap the FAKE
                    mask plane.  This can improve the efficiency of SynPipe.}
        \item \plan{Right now, the SynPipe applies PSF convolution to synthetic object 
                    using the exactly ``accurate'' PSF model from HSC pipeline. 
                    We can simulate the typical PSF model uncertainty by reconstructing 
                    PSF model using a different location on the same Visit.}
        \item \plan{Accuracy of background subtraction has not been taken into account}
    \end{itemize}

%% ------------------------------------------------------------------------------------ %% 
  
\begin{ack}

    The Hyper Suprime-Cam (HSC) collaboration includes the astronomical communities of 
    Japan and Taiwan, and Princeton University.  
    The HSC instrumentation and software were developed by the National Astronomical 
    Observatory of Japan (NAOJ), the Kavli Institute for the Physics and Mathematics of
    the Universe (Kavli IPMU), the University of Tokyo, the High Energy Accelerator 
    Research Organization (KEK), the Academia Sinica Institute for Astronomy and 
    Astrophysics in Taiwan (ASIAA), and Princeton University.
    Funding was contributed by the FIRST program from Japanese Cabinet Office, the 
    Ministry of Education, Culture, Sports, Science and Technology (MEXT), the Japan 
    Society for the Promotion of Science (JSPS), Japan Science and Technology Agency 
    (JST), the Toray Science  Foundation, NAOJ, Kavli IPMU, KEK, ASIAA, and Princeton 
    University.

    This paper makes use of software developed for the Large Synoptic Survey Telescope. 
    We thank the LSST Project for making their code available as free software at 
    http://dm.lsstcorp.org.

    The Pan-STARRS1 Surveys (PS1) have been made possible through contributions of the 
    Institute for Astronomy, the University of Hawaii, the Pan-STARRS Project Office, 
    the Max-Planck Society and its participating institutes, the Max Planck Institute 
    for Astronomy, Heidelberg and the Max Planck Institute for Extraterrestrial Physics, 
    Garching, The Johns Hopkins University, Durham University, the University of 
    Edinburgh, Queen's University Belfast, the Harvard-Smithsonian Center for Astrophysics, 
    the Las Cumbres Observatory Global Telescope Network Incorporated, the National 
    Central University of Taiwan, the Space Telescope Science Institute, the National 
    Aeronautics and Space Administration under Grant No. 
    NNX08AR22G issued through the Planetary Science Division of the NASA Science 
    Mission Directorate, the National Science Foundation under Grant No. AST-1238877, 
    the University of Maryland, and Eotvos Lorand University (ELTE) and the Los Alamos 
    National Laboratory.
   
    This research made use of
    \href{http://www.scipy.org/}{\texttt{SciPy}},
      an open source scientific tools for Python (\citealt{SciPy});
    \href{http://www.numpy.org/}{\texttt{NumPy}}, 
      a fundamental package for scientific computing with Python (\citealt{NumPy});
    \href{http://matplotlib.org/}{\texttt{Matplotlib}}, 
      a 2-D plotting library for Python (\citealt{Matplotlib});
    \href{http://www.astropy.org/}{\texttt{Astropy}}, a community-developed 
      core Python package for Astronomy (\citealt{AstroPy}); 
    \href{http://scikit-learn.org/stable/index.html}{\texttt{scikit-learn}},
      a machine-learning library in Python (\citealt{scikit-learn}); 
    \href{http://www.astroml.org/}{\texttt{astroML}}, 
      a machine learning library for astrophysics (\citealt{astroML});
    \href{https://ipython.org}{\texttt{IPython}}, 
      an interactive computing system for Python (\citealt{IPython}). 

\end{ack}

%%%%%%%%%%: Bibliographic Section %%%%%%%%%%

%\bibliography{synpipe}

%% ------------------------------------------------------------------------------------ %% 

\begin{thebibliography}{}
\expandafter\ifx\csname natexlab\endcsname\relax\def\natexlab#1{#1}\fi

\bibitem[Aihara et al.(2017)]{HSCDR1} Aihara, H., Armstrong, R., Bickerton, S., et al.\ 
         2017, arXiv:1702.08449 

\bibitem[Chang et al.(2015)]{Chang2015} Chang, C., Busha, M.~T., Wechsler, R.~H., et al.\ 
         2015, \apj, 801, 73 

\bibitem[Suchyta et al.(2016)]{Suchyta2016} Suchyta, E., Huff, E.~M., Aleksi{\'c}, J., 
         et al.\ 2016, \mnras, 457, 786 

\end{thebibliography}
%% ------------------------------------------------------------------------------------ %% 

%%%%%%%%%%: Appendix Section %%%%%%%%%%%%

%\appendix

%\section{A. Derive average mass-to-light ratio using \texttt{iSEDFit}} 

%%%%%%%%%%%: Possible Tables %%%%%%%%%%%%%
%\input{table1.tex}

\label{lastpage}
\end{document}
